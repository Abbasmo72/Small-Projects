##  اصلاح متون تایپ شده در زبان اشتباه
این کد برای اصلاح متونی که در زبان اشتباه تایپ شده‌اند طراحی شده است. به این معنا که اگر کاربر قصد تایپ فارسی داشته اما صفحه‌کلید روی انگلیسی بوده (یا برعکس)، کد می‌تواند متن را به زبان صحیح تبدیل کند.

در بسیاری از موارد، افراد هنگام تایپ فارسی، فراموش می‌کنند که صفحه‌کلید را تغییر دهند و متنی ناخوانا دریافت می‌کنند. این کد ابتدا زبان متن را تشخیص داده، سپس کاراکترهای آن را بر اساس یک جدول تبدیل (Mapping) جایگزین می‌کند تا به متن خوانا تبدیل شود. در نهایت، متن اصلاح‌شده را نمایش داده و آن را در کلیپ‌بورد کپی می‌کند تا کاربر بتواند به راحتی از آن استفاده کند.
## تعریف نگاشت (Mapping) بین حروف فارسی و انگلیسی
در ابتدای کد، دو دیکشنری برای نگاشت حروف از انگلیسی به فارسی (eng_to_fa) و فارسی به انگلیسی (fa_to_eng) تعریف شده است:
- تبدیل eng_to_fa: نگاشت کاراکترهای انگلیسی به معادل‌های فارسی آن‌ها. برای مثال، اگر فرد بخواهد «سلام» تایپ کند اما صفحه‌کلید روی انگلیسی باشد، متن به‌صورت sghl ثبت می‌شود. این دیکشنری این مشکل را برطرف کرده و sghl را به «سلام» تبدیل می‌کند.
- تبدیل fa_to_eng: برعکس این تبدیل را انجام می‌دهد، یعنی اگر کاربر به اشتباه صفحه‌کلید را روی فارسی گذاشته و متنی انگلیسی تایپ کرده باشد، متن را به انگلیسی صحیح تبدیل می‌کند.
  
همچنین نسخه‌ی بزرگ (Uppercase) کاراکترهای انگلیسی نیز در eng_to_fa تعریف شده است تا متونی که حروف بزرگ دارند نیز به درستی تبدیل شوند.

## تشخیص زبان متن
تابع detect_language(text) برای تشخیص زبان ورودی استفاده می‌شود. این تابع تعداد حروف فارسی و انگلیسی را در متن شمارش کرده و مشخص می‌کند که کدام یک بیشتر است.
- اگر متن دارای بیشتر حروف انگلیسی باشد، به عنوان متن انگلیسی در نظر گرفته می‌شود.
- اگر تعداد حروف فارسی بیشتر باشد، متن فارسی در نظر گرفته می‌شود.<br>

روش شمارش حروف:
- ابتدا با استفاده از Counter تعداد وقوع هر کاراکتر در متن را می‌شمارد.
- سپس با یک حلقه، تعداد حروف انگلیسی (از طریق string.ascii_letters) و فارسی (از طریق کلیدهای fa_to_eng) را بررسی می‌کند.
- در نهایت، اگر تعداد حروف انگلیسی بیشتر باشد، "eng" و در غیر این صورت "fa" را برمی‌گرداند.
## تبدیل متن به زبان صحیح
تابع fix_keyboard_language(text) پس از تشخیص زبان، از جدول‌های نگاشت (Mapping) استفاده کرده و متن را به زبان صحیح تبدیل می‌کند.
### نحوه‌ی تبدیل:
1. ابتدا زبان متن با detect_language(text) شناسایی می‌شود.
2. سپس، بسته به این که متن در اصل به چه زبانی بوده، یکی از دو دیکشنری eng_to_fa یا fa_to_eng انتخاب می‌شود.
3. یک تابع داخلی translate_match(match) برای جایگزینی کاراکترها تعریف شده که در آن، هر کاراکتر متن ورودی را از طریق جدول نگاشت جایگزین می‌کند.
4. این جایگزینی روی کل متن با استفاده از re.sub(r".", translate_match, text) اعمال می‌شود، که به ازای هر کاراکتر در متن، معادل درست آن را پیدا و جایگزین می‌کند.

## دریافت ورودی از کاربر و اصلاح آن
در بخش if __name__ == "__main__":، این مراحل انجام می‌شود:
1. متن ورودی از کاربر دریافت می‌شود (input("Enter your text: ")).
2. متن اصلاح می‌شود (fix_keyboard_language(user_input)).
3. متن اصلاح‌شده در خروجی چاپ می‌شود.
4. متن اصلاح‌شده در کلیپ‌بورد (pyperclip.copy(corrected_text)) کپی می‌شود تا کاربر بتواند آن را مستقیماً در جای مورد نظر پیست کند.
5. پیامی نمایش داده می‌شود که متن به کلیپ‌بورد کپی شده است.

## نتیجه‌گیری
این کد یک ابزار کاربردی برای تبدیل متن‌های تایپ‌شده در زبان اشتباه است. با تشخیص زبان، استفاده از نگاشت‌های کاراکتری و جایگزینی سریع حروف، این کد می‌تواند به کاربران در تصحیح متن کمک کند. همچنین، قابلیت کپی خودکار متن اصلاح‌شده به کلیپ‌بورد باعث افزایش کارایی آن شده است.

## کد پایتون
```python
import re
import string
import pyperclip
from collections import Counter

# نگاشت کیبورد انگلیسی به فارسی
eng_to_fa = {
    "q": "ض", "w": "ص", "e": "ث", "r": "ق", "t": "ف", "y": "غ", "u": "ع", "i": "ه", "o": "خ", "p": "ح",
    "[": "ج", "]": "چ", "a": "ش", "s": "س", "d": "ی", "f": "ب", "g": "ل", "h": "ا", "j": "ت",
    "k": "ن", "l": "م", ";": "ک", "'": "گ", "z": "ظ", "x": "ط", "c": "ز", "v": "ر", "b": "ذ",
    "n": "د", "m": "پ", ",": "و", "x": "ژ", "?": "/", "~": "÷", "@": "٬", "#": "٫", "$": "﷼",
    "%": "٪", "^": "×", "&": "،", "*": "÷", "_": "ـ", "=": "+", "{": "»", "}": "«", "<": "‹", ">": "›",
    "|": "¦", "0": "۰", "1": "۱", "2": "۲", "3": "۳", "4": "۴", "5": "۵", "6": "۶", "7": "۷", "8": "۸", "9": "۹"
}

# ایجاد نگاشت برای حروف بزرگ
eng_to_fa_upper = {k.upper(): v for k, v in eng_to_fa.items()}
eng_to_fa.update(eng_to_fa_upper)

# ایجاد نگاشت فارسی به انگلیسی
fa_to_eng = {v: k for k, v in eng_to_fa.items()}

# تابع تشخیص زبان
def detect_language(text):
    counter = Counter(text)
    eng_count = sum(counter[ch] for ch in string.ascii_letters)
    fa_count = sum(counter[ch] for ch in fa_to_eng)
    return "eng" if eng_count > fa_count else "fa"

# تبدیل متن بر اساس زبان تشخیص داده شده
def fix_keyboard_language(text):
    if not text:
        return ""
    
    lang = detect_language(text)
    mapping = eng_to_fa if lang == "eng" else fa_to_eng
    
    def translate_match(match):
        return mapping.get(match.group(0), match.group(0))
    
    return re.sub(r".", translate_match, text)

if __name__ == "__main__":
    user_input = input("متن خود را وارد کنید: ")
    corrected_text = fix_keyboard_language(user_input)
    print("متن تصحیح‌شده:", corrected_text)
    pyperclip.copy(corrected_text)
    print("(متن به کلیپ‌بورد کپی شد)")

```
